🧭 전체 개선 지시문 – 지도·탐색·홈 통합
현재 서비스 전반에서 아래와 같은 문제가 확인됨:
탐색창의 필터·정렬·지역 선택이 데이터베이스와 제대로 연동되지 않음.
“알 수 없는 지역”으로 표시되며 지역 선택 드롭다운이 작동하지 않음.
“총 0개의 혜택” 문구가 UI상 짤림.
정렬 조건(거리순, 인기순, 신규순, 마감임박순) 적용 여부 불분명.
홈 화면 상단 배너(“주변 혜택을 빠르게 찾아보세요” 등)를 관리자가 직접 수정·추가할 수 없음.
지도창에서 목록창과 지도 UI(내 위치, 확대, 축소) 가 겹침.
하단 메뉴바와 지도 컨트롤이 살짝 겹쳐 있음.
카테고리(뷰티, 쇼핑, 음식, 카페, 헬스)가 DB에 분류되어 있지 않음.
이하 항목별로 수정 및 구현 방향을 구체적으로 제시한다.
1️⃣ 데이터베이스 연동 구조 개선
(1) 카테고리 구조 추가
benefits 테이블에 category_id를 추가하고,
별도 categories 테이블을 만들어 정규화한다.
CREATE TABLE categories (
  id SERIAL PRIMARY KEY,
  name VARCHAR(50) UNIQUE NOT NULL, -- 뷰티, 쇼핑, 음식, 카페, 헬스
  icon_url TEXT
);
ALTER TABLE benefits ADD COLUMN category_id INTEGER REFERENCES categories(id);
→ 앱의 카테고리 버튼(뷰티/쇼핑/음식/카페/헬스)은 categories 테이블에서 직접 로드하도록 한다.
→ 선택된 카테고리는 API 쿼리 시 ?category=beauty 형태로 전달되어 SQL 필터에 반영.
(2) 지역(권역) 연동 및 위치 감지
현재 “알 수 없는 지역”은 navigator.geolocation 실패 시 기본값이 없어서 발생.
수정 방식:
앱 실행 시 현재 좌표를 얻지 못할 경우 default_region_id = '제주시'로 설정.
regions 테이블을 이용해 좌표 기준으로 권역명 표시:
SELECT name
FROM regions
WHERE ST_Contains(geom, ST_SetSRID(ST_MakePoint(:lng, :lat), 4326))
LIMIT 1;
해당 결과가 없을 경우 “위치 정보 없음” 대신 “제주시 전체”로 표시.
지역 드롭다운은 regions 테이블의 권역 목록(아라권, 삼화권, 시청권 등)을 로드해 클릭 이벤트로 지역 이동.
2️⃣ 필터 및 정렬 로직 연결
탐색화면의 카테고리 / 정렬 / 지금 사용 가능 필터가 실제 DB 쿼리에 반영되도록 한다.
서버 측 API 예시:
GET /api/benefits?category=beauty&sort=distance&nowOpen=true&regionId=ARA
서버는 SQL 조건문을 다음과 같이 처리:
WHERE b.status='PUBLISHED'
  AND (:category IS NULL OR b.category_id = :category)
  AND (:regionId IS NULL OR m.region_id = :regionId)
  AND (:nowOpen IS FALSE OR current_time BETWEEN h.open AND h.close)
ORDER BY
  CASE WHEN :sort='distance' THEN ST_Distance(m.location, :user_loc)
       WHEN :sort='popular' THEN b.click_count
       WHEN :sort='new' THEN b.created_at DESC
       WHEN :sort='expire' THEN b.valid_to ASC
  END
✅ 이렇게 해야 거리순, 인기순, 신규순, 마감임박순 모두 서버에서 정렬된 결과로 반영된다.
3️⃣ 홈 배너·포스터 관리자 제어
홈 상단의 “주변 혜택을 빠르게 찾아보세요” 같은 안내 포스터는
home_banners 테이블로 관리하고 관리자 페이지에서 직접 CRUD 가능하게 한다.
CREATE TABLE home_banners (
  id SERIAL PRIMARY KEY,
  title TEXT,
  subtitle TEXT,
  image_url TEXT,
  link_url TEXT,
  order_index INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT TRUE
);
관리자 페이지 기능
썸네일 업로드(S3), 텍스트 수정, 순서 변경, 노출 여부 on/off.
미리보기 지원(자동 슬라이드 전환 3~5초 간격).
사용자 홈에서는 GET /api/banners?active=true 로 로드,
자동 슬라이드 또는 드래그 전환 모두 지원.
4️⃣ UI 레이아웃 수정
(1) “총 N개의 혜택” 짤림 수정
텍스트 컨테이너에 overflow: visible 적용,
폰트 크기 14px → 13px, 줄 높이 1.2로 조정.
(2) 지도 UX 계층 조정
지도 컨트롤(내 위치, 확대, 축소)은 항상 목록창 뒤쪽에 위치해야 한다.
.map-controls { position: absolute; z-index: 900; }
.bottom-sheet { position: fixed; z-index: 1200; }
→ 바텀시트가 올라올 때 지도 컨트롤은 자동으로 투명 처리:
sheet.addEventListener('onExpand', () => controls.style.opacity = 0);
sheet.addEventListener('onCollapse', () => controls.style.opacity = 1);
(3) 하단 메뉴바 겹침 보정
현재 메뉴바와 지도 버튼이 10~15px 정도 겹침.
→ 메뉴바 높이(64px)를 유지하되, 지도 버튼 컨테이너를 약간 위로 이동:
.map-controls { bottom: 80px; } /* 기존보다 16px 위 */
5️⃣ 탐색창 동작 흐름 확인 (지도→탐색)
지도창에서 “목록보기” 클릭 시 탐색(검색 결과) 화면으로 이동하는 것은 올바른 UX임.
(목록보기 → 전체 리스트 탐색 구조가 일관성 있음)
단, 이동 시 현재 필터 상태와 지역 정보가 그대로 유지되도록 해야 한다.
→ 라우팅 시 querystring으로 필터 전달
예: /explore?region=ARA&sort=distance&category=beauty
6️⃣ 추가 UX 개선 (세부)
검색창 입력 시 자동완성: 업체명·카테고리 기반 추천.
“알 수 없는 지역” 문구를 “위치 정보 없음”으로 변경해 사용자 혼란 방지.
“총 0개의 혜택”일 때는 빈 상태 메시지:
“이 지역에는 아직 등록된 혜택이 없습니다.
다른 지역이나 카테고리를 선택해보세요.”
✅ 정리 요약
DB에 categories, home_banners 추가.
지역(regions) 및 현재 위치 연동 개선 → “알 수 없는 지역” 제거.
필터/정렬 조건을 서버 SQL로 직접 연결해 실제 데이터 기준으로 탐색 가능.
홈 배너는 관리자 페이지에서 이미지·텍스트·링크 수정 가능,
사용자 홈에서는 자동 슬라이드 전환 + 드래그 전환 지원.
지도 컨트롤은 목록창 뒤로 배치, 하단 메뉴바는 겹치지 않게 위로 16px 이동.
“목록보기” → “탐색창” 이동 구조는 그대로 유지하되, 필터 상태는 유지되게 한다.